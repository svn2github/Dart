<!DOCTYPE html>
<!--
Copyright (c) 2012, the Dart project authors.  Please see the AUTHORS file
for details. All rights reserved. Use of this source code is governed by a
BSD-style license that can be found in the LICENSE file.
-->
<html lang="en">
<body>
<element name="x-todo-form" extends="div" constructor="FormComponent"
         apply-author-styles>
  <template>
    <!-- Note: <form> is to make "enter" work on Opera/IE. -->
    <form on-submit="addTodo($event)">
      <input id="new-todo" placeholder="What needs to be done?" autofocus
             on-change="addTodo($event)">
    </form>
  </template>
  <script type="application/dart">
  import 'dart:html';
  import 'package:web_components/web_components.dart';
  import 'model.dart';

  class FormComponent extends WebComponent {
    InputElement input;
    void created() {
      super.created();
      input = _root.query('#new-todo');
    }

    void addTodo(e) {
      e.preventDefault(); // don't submit the form
      if (input.value == '') return;
      app.todos.add(new Todo(input.value));
      input.value = '';
    }
  }
  </script>
</element>
</body>
</html>
